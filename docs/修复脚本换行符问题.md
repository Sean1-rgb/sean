# 修复脚本换行符问题

## 问题

错误：`cannot execute: required file not found`

**原因**：脚本文件有 Windows 换行符（CRLF），WSL 需要 Unix 换行符（LF）。

## 快速修复

### 方法一：转换换行符（推荐）

```bash
# 转换脚本文件的换行符
sed -i 's/\r$//' setup-ssh-persistent.sh

# 然后重新执行
./setup-ssh-persistent.sh
```

### 方法二：使用 dos2unix（如果已安装）

```bash
# 安装 dos2unix（如果未安装）
sudo apt-get update && sudo apt-get install -y dos2unix

# 转换文件
dos2unix setup-ssh-persistent.sh

# 执行
./setup-ssh-persistent.sh
```

### 方法三：手动执行命令

如果脚本还是有问题，可以直接手动执行以下命令：

```bash
# 创建目录
mkdir -p jenkins-ssh
chmod 700 jenkins-ssh

# 生成密钥（如果不存在）
if [ ! -f "jenkins-ssh/id_rsa" ]; then
    ssh-keygen -t rsa -b 4096 -C "jenkins@docker" -f ./jenkins-ssh/id_rsa -N ""
fi

# 设置权限
chmod 600 jenkins-ssh/id_rsa
chmod 644 jenkins-ssh/id_rsa.pub

# 添加 GitHub 到 known_hosts
if [ ! -f "jenkins-ssh/known_hosts" ] || ! grep -q "github.com" jenkins-ssh/known_hosts 2>/dev/null; then
    ssh-keyscan github.com >> jenkins-ssh/known_hosts 2>/dev/null
    chmod 644 jenkins-ssh/known_hosts
fi

# 查看公钥
echo "公钥内容（添加到 GitHub）："
cat jenkins-ssh/id_rsa.pub
```

## 预防措施

### 配置 Git 自动转换换行符

```bash
# 在项目根目录配置
git config core.autocrlf input

# 或者全局配置
git config --global core.autocrlf input
```

这样 Git 会自动将 CRLF 转换为 LF。
