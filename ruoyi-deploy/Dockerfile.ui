# 若依 RuoYi-Vue 前端 Dockerfile（多阶段：镜像内构建）
# 在若依项目根目录执行：docker build -f Dockerfile.ui -t ruoyi-ui .

# 阶段1：构建前端
FROM node:18-alpine AS builder
WORKDIR /app
COPY ruoyi-ui/package*.json ./
RUN npm install --registry=https://registry.npmmirror.com
COPY ruoyi-ui/ .
RUN npm run build:prod

# 阶段2：Nginx 托管
FROM nginx:alpine
WORKDIR /usr/share/nginx/html
COPY --from=builder /app/dist/ /usr/share/nginx/html/
COPY nginx.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
